<div class="container">
  <div class="card mt-5">
    <div class="card-header justify-content-between align-items-center d-flex">
      <h1>Readings</h1>
      <div class="d-flex gap-3">
        <custom-button (click)="showFilters = !showFilters" [label]="showFilters ? 'Hide Filters' : 'Show Filters'"
                       [icon]="showFilters ? 'eye-slash' : 'eye'" color="warning"/>
        <custom-button [link]="['/readings/create']" label="Create Reading" icon="plus-lg"/>
      </div>

    </div>
    <div class="card-body table-responsive">
      <div *ngIf="showFilters" class="mb-3 row border-bottom pb-4">
        <div class="col-4">
          <label for="search" class="form-label">Search:</label>
          <input [(ngModel)]="query" type="text" class="form-control" id="search">
        </div>

        <div class="col-2">
          <label for="kindOfMeter-filter" class="form-label">Meter Type</label>
          <select [(ngModel)]="kindOfMeterFilter" id="kindOfMeter-filter" class="form-select">
            <option selected [value]="undefined"> All </option>
            <option *ngFor="let kindOfMeter of kindOfMeter()" value="{{ kindOfMeter }}">{{ kindOfMeter }}</option>
          </select>
        </div>

        <div class="col-2">
          <label for="substitute-filter" class="form-label">Is Substitute</label>
          <select [(ngModel)]="substituteFilter" id="substitute-filter" class="form-select">
            <option selected [value]="undefined">All</option>
            <option [value]="true">Yes</option>
            <option [value]="false">No</option>
          </select>
        </div>

        <div class="col-2 d-flex flex-column justify-content-end align-items-stretch">
          <custom-button (click)="clearFilters()" label="Clear Filters" color="danger"/>
        </div>
        <div class="col-2 d-flex flex-column justify-content-end align-items-stretch">
          <custom-button (click)="applyFilters()" label="Apply Filters"/>
        </div>

      </div>
      <table class="table table-striped table-hover">
        <thead>
        <tr>
          <th>ID</th>
          <th>Customer ID</th>
          <th>
            <button (click)="changeOrderBy('dateOfReading')" class="btn fw-bold p-0 border-0 w-100 d-flex justify-content-between">
              <span>Date</span>
              <ng-icon *ngIf="orderBy === 'dateOfReading'" [name]="orderDirection === 'desc' ? 'bootstrapCaretDownFill' : 'bootstrapCaretUpFill'" />
              <ng-icon *ngIf="orderBy !== 'dateOfReading'" name="" />
            </button>
          </th>
          <th>
            <button (click)="changeOrderBy('meterId')" class="btn fw-bold p-0 border-0 w-100 d-flex justify-content-between">
              <span>Meter ID</span>
              <ng-icon *ngIf="orderBy === 'meterId'" [name]="orderDirection === 'desc' ? 'bootstrapCaretDownFill' : 'bootstrapCaretUpFill'" />
              <ng-icon *ngIf="orderBy !== 'meterId'" name="" />
            </button>
          </th>
          <th>
            <button (click)="changeOrderBy('meterCount')" class="btn fw-bold p-0 border-0 w-100 d-flex justify-content-between">
              <span>Meter Count</span>
              <ng-icon *ngIf="orderBy === 'meterCount'" [name]="orderDirection === 'desc' ? 'bootstrapCaretDownFill' : 'bootstrapCaretUpFill'" />
              <ng-icon *ngIf="orderBy !== 'meterCount'" name="" />
            </button>
          </th>
          <th>
            <button (click)="changeOrderBy('kindOfMeter')" class="btn fw-bold p-0 border-0 w-100 d-flex justify-content-between">
              <span>Meter Type</span>
              <ng-icon *ngIf="orderBy === 'kindOfMeter'" [name]="orderDirection === 'desc' ? 'bootstrapCaretDownFill' : 'bootstrapCaretUpFill'" />
              <ng-icon *ngIf="orderBy !== 'kindOfMeter'" name="" />
            </button>
          </th>
          <th>
            <button (click)="changeOrderBy('comment')" class="btn fw-bold p-0 border-0 w-100 d-flex justify-content-between">
              <span>Comment</span>
              <ng-icon *ngIf="orderBy === 'comment'" [name]="orderDirection === 'desc' ? 'bootstrapCaretDownFill' : 'bootstrapCaretUpFill'" />
              <ng-icon *ngIf="orderBy !== 'comment'" name="" />
            </button>
          </th>
          <th>
            <button (click)="changeOrderBy('substitute')" class="btn fw-bold p-0 border-0 w-100 d-flex justify-content-between">
              <span>Substitute</span>
              <ng-icon *ngIf="orderBy === 'substitute'" [name]="orderDirection === 'desc' ? 'bootstrapCaretDownFill' : 'bootstrapCaretUpFill'" />
              <ng-icon *ngIf="orderBy !== 'substitute'" name="" />
            </button>
          </th>
        </tr>
        </thead>
        <tbody>

        <tr class="readings user-select-none" *ngFor="let readings of readings"
            (click)="router.navigate(['/readings', readings.id])">
          <td>{{ readings.id }}</td>
          <td>{{ readings.customer.id }}</td>
          <td>{{ readings.dateOfReading}}</td>
          <td>{{ readings.meterId }}</td>
          <td>{{ readings.meterCount }}</td>
          <td>{{ readings.kindOfMeter }}</td>
          <td>{{ readings.comment }}</td>
          <td>{{ readings.substitute }}</td>
        </tr>

        </tbody>
      </table>
    </div>
  </div>
</div>
